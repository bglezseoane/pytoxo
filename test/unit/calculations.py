# -*- coding: utf-8 -*-

###########################################################
# PyToxo
#
# A Python library for calculating penetrance tables of any
# bivariate epistasis model.
#
# Copyright 2021 Borja Gonz√°lez Seoane
#
# Contact: borja.gseoane@udc.es
###########################################################

"""PyToxo genotype probabilities computation unit test suite."""

import unittest

from pytoxo.calculations import genotype_probabilities, compute_prevalence


class GenotypeProbabilitiesUnitTestSuite(unittest.TestCase):
    """Tests for `pytoxo/calculations.py` at unit level."""

    def test_genotype_probabilities_order(self):
        """Test the output disposition to be the same as Toxo's one."""
        input_mafs = [1, 1, 0]

        # Output from Toxo's `genotype_probabilities` function for `input_mafs` input
        expected_output = [
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            1,
            0,
            0,
        ]

        output = genotype_probabilities(input_mafs)

        self.assertEqual(expected_output, output)

    def test_genotype_probabilities_1(self):
        """Test that PyToxo and Toxo `genotype_probabilities` functions work
        equal with a given configuration."""
        input_mafs = [0.1, 0.1, 0.1]

        # Output from Toxo's `genotype_probabilities` function for `input_mafs` input
        expected_output = [
            531441 / 1000000,
            59049 / 500000,
            6561 / 1000000,
            59049 / 500000,
            6561 / 250000,
            729 / 500000,
            6561 / 1000000,
            729 / 500000,
            81 / 1000000,
            59049 / 500000,
            6561 / 250000,
            729 / 500000,
            6561 / 250000,
            729 / 125000,
            81 / 250000,
            729 / 500000,
            81 / 250000,
            9 / 500000,
            6561 / 1000000,
            729 / 500000,
            81 / 1000000,
            729 / 500000,
            81 / 250000,
            9 / 500000,
            81 / 1000000,
            9 / 500000,
            1 / 1000000,
        ]

        output = genotype_probabilities(input_mafs)

        for par in zip(expected_output, output):
            self.assertAlmostEqual(par[0], par[1])  # Default precision 7 decimals

    def test_genotype_probabilities_2(self):
        """Test that PyToxo and Toxo `genotype_probabilities` functions work
        equal with a given configuration."""
        input_mafs = [0.1, 0.4, 0.5]

        # Output from Toxo's `genotype_probabilities` function for `input_mafs` input
        expected_output = [
            729 / 10000,
            729 / 5000,
            729 / 10000,
            243 / 2500,
            243 / 1250,
            243 / 2500,
            81 / 2500,
            81 / 1250,
            81 / 2500,
            81 / 5000,
            81 / 2500,
            81 / 5000,
            27 / 1250,
            27 / 625,
            27 / 1250,
            9 / 1250,
            9 / 625,
            9 / 1250,
            9 / 10000,
            9 / 5000,
            9 / 10000,
            3 / 2500,
            3 / 1250,
            3 / 2500,
            1 / 2500,
            1 / 1250,
            1 / 2500,
        ]

        output = genotype_probabilities(input_mafs)

        for par in zip(expected_output, output):
            self.assertAlmostEqual(par[0], par[1])  # Default precision 7 decimals

    def test_genotype_probabilities_3(self):
        """Test that PyToxo and Toxo `genotype_probabilities` functions work
        equal with a given configuration."""
        input_mafs = [0.01, 0.05, 0.5, 0.7, 0.87, 0.543]

        # Output from Toxo's `genotype_probabilities` function for `input_mafs` input
        expected_output = [
            1123929849153969 / 16000000000000000000,
            1335435247463031 / 8000000000000000000,
            1586742536919969 / 16000000000000000000,
            7521684375107331 / 8000000000000000000,
            8937143579175669 / 4000000000000000000,
            10618969285541331 / 8000000000000000000,
            50337426202641369 / 16000000000000000000,
            59810114722175631 / 8000000000000000000,
            71065409834007369 / 16000000000000000000,
            2622502981359261 / 8000000000000000000,
            3116015577413739 / 4000000000000000000,
            3702399252813261 / 8000000000000000000,
            17550596875250439 / 4000000000000000000,
            20853335018076561 / 2000000000000000000,
            24777594999596439 / 4000000000000000000,
            117453994472829861 / 8000000000000000000,
            139556934351743139 / 4000000000000000000,
            165819289612683861 / 8000000000000000000,
            6119173623171609 / 16000000000000000000,
            7270703013965391 / 8000000000000000000,
            8638931589897609 / 16000000000000000000,
            40951392708917691 / 8000000000000000000,
            48657781708845309 / 4000000000000000000,
            57814388332391691 / 8000000000000000000,
            274059320436603009 / 16000000000000000000,
            325632846820733991 / 8000000000000000000,
            386911675762929009 / 16000000000000000000,
            1123929849153969 / 8000000000000000000,
            1335435247463031 / 4000000000000000000,
            1586742536919969 / 8000000000000000000,
            7521684375107331 / 4000000000000000000,
            8937143579175669 / 2000000000000000000,
            10618969285541331 / 4000000000000000000,
            50337426202641369 / 8000000000000000000,
            59810114722175631 / 4000000000000000000,
            71065409834007369 / 8000000000000000000,
            2622502981359261 / 4000000000000000000,
            3116015577413739 / 2000000000000000000,
            3702399252813261 / 4000000000000000000,
            17550596875250439 / 2000000000000000000,
            20853335018076561 / 1000000000000000000,
            24777594999596439 / 2000000000000000000,
            117453994472829861 / 4000000000000000000,
            139556934351743139 / 2000000000000000000,
            165819289612683861 / 4000000000000000000,
            6119173623171609 / 8000000000000000000,
            7270703013965391 / 4000000000000000000,
            8638931589897609 / 8000000000000000000,
            40951392708917691 / 4000000000000000000,
            48657781708845309 / 2000000000000000000,
            57814388332391691 / 4000000000000000000,
            274059320436603009 / 8000000000000000000,
            325632846820733991 / 4000000000000000000,
            386911675762929009 / 8000000000000000000,
            1123929849153969 / 16000000000000000000,
            1335435247463031 / 8000000000000000000,
            1586742536919969 / 16000000000000000000,
            7521684375107331 / 8000000000000000000,
            8937143579175669 / 4000000000000000000,
            10618969285541331 / 8000000000000000000,
            50337426202641369 / 16000000000000000000,
            59810114722175631 / 8000000000000000000,
            71065409834007369 / 16000000000000000000,
            2622502981359261 / 8000000000000000000,
            3116015577413739 / 4000000000000000000,
            3702399252813261 / 8000000000000000000,
            17550596875250439 / 4000000000000000000,
            20853335018076561 / 2000000000000000000,
            24777594999596439 / 4000000000000000000,
            117453994472829861 / 8000000000000000000,
            139556934351743139 / 4000000000000000000,
            165819289612683861 / 8000000000000000000,
            6119173623171609 / 16000000000000000000,
            7270703013965391 / 8000000000000000000,
            8638931589897609 / 16000000000000000000,
            40951392708917691 / 8000000000000000000,
            48657781708845309 / 4000000000000000000,
            57814388332391691 / 8000000000000000000,
            274059320436603009 / 16000000000000000000,
            325632846820733991 / 8000000000000000000,
            386911675762929009 / 16000000000000000000,
            59154202587051 / 8000000000000000000,
            70286065655949 / 4000000000000000000,
            83512765101051 / 8000000000000000000,
            395878125005649 / 4000000000000000000,
            470375977851351 / 2000000000000000000,
            558893120291649 / 4000000000000000000,
            2649338221191651 / 8000000000000000000,
            3147900774851349 / 4000000000000000000,
            3740284728105651 / 8000000000000000000,
            138026472703119 / 4000000000000000000,
            164000819863881 / 2000000000000000000,
            194863118569119 / 4000000000000000000,
            923715625013181 / 2000000000000000000,
            1097543948319819 / 1000000000000000000,
            1304083947347181 / 2000000000000000000,
            6181789182780519 / 4000000000000000000,
            7345101807986481 / 2000000000000000000,
            8727331032246519 / 4000000000000000000,
            322061769640611 / 8000000000000000000,
            382668579682389 / 4000000000000000000,
            454680609994611 / 8000000000000000000,
            2155336458364089 / 4000000000000000000,
            2560935879412911 / 2000000000000000000,
            3042862543810089 / 4000000000000000000,
            14424174759821211 / 8000000000000000000,
            17138570885301789 / 4000000000000000000,
            20363772408575211 / 8000000000000000000,
            59154202587051 / 4000000000000000000,
            70286065655949 / 2000000000000000000,
            83512765101051 / 4000000000000000000,
            395878125005649 / 2000000000000000000,
            470375977851351 / 1000000000000000000,
            558893120291649 / 2000000000000000000,
            2649338221191651 / 4000000000000000000,
            3147900774851349 / 2000000000000000000,
            3740284728105651 / 4000000000000000000,
            138026472703119 / 2000000000000000000,
            164000819863881 / 1000000000000000000,
            194863118569119 / 2000000000000000000,
            923715625013181 / 1000000000000000000,
            1097543948319819 / 500000000000000000,
            1304083947347181 / 1000000000000000000,
            6181789182780519 / 2000000000000000000,
            7345101807986481 / 1000000000000000000,
            8727331032246519 / 2000000000000000000,
            322061769640611 / 4000000000000000000,
            382668579682389 / 2000000000000000000,
            454680609994611 / 4000000000000000000,
            2155336458364089 / 2000000000000000000,
            2560935879412911 / 1000000000000000000,
            3042862543810089 / 2000000000000000000,
            14424174759821211 / 4000000000000000000,
            17138570885301789 / 2000000000000000000,
            20363772408575211 / 4000000000000000000,
            59154202587051 / 8000000000000000000,
            70286065655949 / 4000000000000000000,
            83512765101051 / 8000000000000000000,
            395878125005649 / 4000000000000000000,
            470375977851351 / 2000000000000000000,
            558893120291649 / 4000000000000000000,
            2649338221191651 / 8000000000000000000,
            3147900774851349 / 4000000000000000000,
            3740284728105651 / 8000000000000000000,
            138026472703119 / 4000000000000000000,
            164000819863881 / 2000000000000000000,
            194863118569119 / 4000000000000000000,
            923715625013181 / 2000000000000000000,
            1097543948319819 / 1000000000000000000,
            1304083947347181 / 2000000000000000000,
            6181789182780519 / 4000000000000000000,
            7345101807986481 / 2000000000000000000,
            8727331032246519 / 4000000000000000000,
            322061769640611 / 8000000000000000000,
            382668579682389 / 4000000000000000000,
            454680609994611 / 8000000000000000000,
            2155336458364089 / 4000000000000000000,
            2560935879412911 / 2000000000000000000,
            3042862543810089 / 4000000000000000000,
            14424174759821211 / 8000000000000000000,
            17138570885301789 / 4000000000000000000,
            20363772408575211 / 8000000000000000000,
            3113379083529 / 16000000000000000000,
            3699266613471 / 8000000000000000000,
            4395408689529 / 16000000000000000000,
            20835690789771 / 8000000000000000000,
            24756630413229 / 4000000000000000000,
            29415427383771 / 8000000000000000000,
            139438853746929 / 16000000000000000000,
            165678988150071 / 8000000000000000000,
            196857090952929 / 16000000000000000000,
            7264551194901 / 8000000000000000000,
            8631622098099 / 4000000000000000000,
            10255953608901 / 8000000000000000000,
            48616611842799 / 4000000000000000000,
            57765470964201 / 2000000000000000000,
            68635997228799 / 4000000000000000000,
            325357325409501 / 8000000000000000000,
            386584305683499 / 4000000000000000000,
            459333212223501 / 8000000000000000000,
            16950619454769 / 16000000000000000000,
            20140451562231 / 8000000000000000000,
            23930558420769 / 16000000000000000000,
            113438760966531 / 8000000000000000000,
            134786098916469 / 4000000000000000000,
            160150660200531 / 8000000000000000000,
            759167092622169 / 16000000000000000000,
            902030046594831 / 8000000000000000000,
            1071777495188169 / 16000000000000000000,
            3113379083529 / 8000000000000000000,
            3699266613471 / 4000000000000000000,
            4395408689529 / 8000000000000000000,
            20835690789771 / 4000000000000000000,
            24756630413229 / 2000000000000000000,
            29415427383771 / 4000000000000000000,
            139438853746929 / 8000000000000000000,
            165678988150071 / 4000000000000000000,
            196857090952929 / 8000000000000000000,
            7264551194901 / 4000000000000000000,
            8631622098099 / 2000000000000000000,
            10255953608901 / 4000000000000000000,
            48616611842799 / 2000000000000000000,
            57765470964201 / 1000000000000000000,
            68635997228799 / 2000000000000000000,
            325357325409501 / 4000000000000000000,
            386584305683499 / 2000000000000000000,
            459333212223501 / 4000000000000000000,
            16950619454769 / 8000000000000000000,
            20140451562231 / 4000000000000000000,
            23930558420769 / 8000000000000000000,
            113438760966531 / 4000000000000000000,
            134786098916469 / 2000000000000000000,
            160150660200531 / 4000000000000000000,
            759167092622169 / 8000000000000000000,
            902030046594831 / 4000000000000000000,
            1071777495188169 / 8000000000000000000,
            3113379083529 / 16000000000000000000,
            3699266613471 / 8000000000000000000,
            4395408689529 / 16000000000000000000,
            20835690789771 / 8000000000000000000,
            24756630413229 / 4000000000000000000,
            29415427383771 / 8000000000000000000,
            139438853746929 / 16000000000000000000,
            165678988150071 / 8000000000000000000,
            196857090952929 / 16000000000000000000,
            7264551194901 / 8000000000000000000,
            8631622098099 / 4000000000000000000,
            10255953608901 / 8000000000000000000,
            48616611842799 / 4000000000000000000,
            57765470964201 / 2000000000000000000,
            68635997228799 / 4000000000000000000,
            325357325409501 / 8000000000000000000,
            386584305683499 / 4000000000000000000,
            459333212223501 / 8000000000000000000,
            16950619454769 / 16000000000000000000,
            20140451562231 / 8000000000000000000,
            23930558420769 / 16000000000000000000,
            113438760966531 / 8000000000000000000,
            134786098916469 / 4000000000000000000,
            160150660200531 / 8000000000000000000,
            759167092622169 / 16000000000000000000,
            902030046594831 / 8000000000000000000,
            1071777495188169 / 16000000000000000000,
            11352826759131 / 8000000000000000000,
            13489244923869 / 4000000000000000000,
            16027702393131 / 8000000000000000000,
            75976609849569 / 4000000000000000000,
            90274177567431 / 2000000000000000000,
            107262316015569 / 4000000000000000000,
            508458850531731 / 8000000000000000000,
            604142572951269 / 4000000000000000000,
            717832422565731 / 8000000000000000000,
            26489929104639 / 4000000000000000000,
            31474904822361 / 2000000000000000000,
            37397972250639 / 4000000000000000000,
            177278756315661 / 2000000000000000000,
            210639747657339 / 1000000000000000000,
            250278737369661 / 2000000000000000000,
            1186403984574039 / 4000000000000000000,
            1409666003552961 / 2000000000000000000,
            1674942319320039 / 4000000000000000000,
            61809834577491 / 8000000000000000000,
            73441444585509 / 4000000000000000000,
            87261935251491 / 8000000000000000000,
            413650431403209 / 4000000000000000000,
            491492744533791 / 2000000000000000000,
            583983720529209 / 4000000000000000000,
            2768275964006091 / 8000000000000000000,
            3289220674956909 / 4000000000000000000,
            3908198745080091 / 8000000000000000000,
            11352826759131 / 4000000000000000000,
            13489244923869 / 2000000000000000000,
            16027702393131 / 4000000000000000000,
            75976609849569 / 2000000000000000000,
            90274177567431 / 1000000000000000000,
            107262316015569 / 2000000000000000000,
            508458850531731 / 4000000000000000000,
            604142572951269 / 2000000000000000000,
            717832422565731 / 4000000000000000000,
            26489929104639 / 2000000000000000000,
            31474904822361 / 1000000000000000000,
            37397972250639 / 2000000000000000000,
            177278756315661 / 1000000000000000000,
            210639747657339 / 500000000000000000,
            250278737369661 / 1000000000000000000,
            1186403984574039 / 2000000000000000000,
            1409666003552961 / 1000000000000000000,
            1674942319320039 / 2000000000000000000,
            61809834577491 / 4000000000000000000,
            73441444585509 / 2000000000000000000,
            87261935251491 / 4000000000000000000,
            413650431403209 / 2000000000000000000,
            491492744533791 / 1000000000000000000,
            583983720529209 / 2000000000000000000,
            2768275964006091 / 4000000000000000000,
            3289220674956909 / 2000000000000000000,
            3908198745080091 / 4000000000000000000,
            11352826759131 / 8000000000000000000,
            13489244923869 / 4000000000000000000,
            16027702393131 / 8000000000000000000,
            75976609849569 / 4000000000000000000,
            90274177567431 / 2000000000000000000,
            107262316015569 / 4000000000000000000,
            508458850531731 / 8000000000000000000,
            604142572951269 / 4000000000000000000,
            717832422565731 / 8000000000000000000,
            26489929104639 / 4000000000000000000,
            31474904822361 / 2000000000000000000,
            37397972250639 / 4000000000000000000,
            177278756315661 / 2000000000000000000,
            210639747657339 / 1000000000000000000,
            250278737369661 / 2000000000000000000,
            1186403984574039 / 4000000000000000000,
            1409666003552961 / 2000000000000000000,
            1674942319320039 / 4000000000000000000,
            61809834577491 / 8000000000000000000,
            73441444585509 / 4000000000000000000,
            87261935251491 / 8000000000000000000,
            413650431403209 / 4000000000000000000,
            491492744533791 / 2000000000000000000,
            583983720529209 / 4000000000000000000,
            2768275964006091 / 8000000000000000000,
            3289220674956909 / 4000000000000000000,
            3908198745080091 / 8000000000000000000,
            597517197849 / 4000000000000000000,
            709960259151 / 2000000000000000000,
            843563283849 / 4000000000000000000,
            3998768939451 / 2000000000000000000,
            4751272503549 / 1000000000000000000,
            5645385053451 / 2000000000000000000,
            26760992133249 / 4000000000000000000,
            31796977523751 / 2000000000000000000,
            37780653819249 / 4000000000000000000,
            1394206794981 / 2000000000000000000,
            1656573938019 / 1000000000000000000,
            1968314328981 / 2000000000000000000,
            9330460858719 / 1000000000000000000,
            11086302508281 / 500000000000000000,
            13172565124719 / 1000000000000000000,
            62442314977581 / 2000000000000000000,
            74192947555419 / 1000000000000000000,
            88154858911581 / 2000000000000000000,
            3253149188289 / 4000000000000000000,
            3865339188711 / 2000000000000000000,
            4592733434289 / 4000000000000000000,
            21771075337011 / 2000000000000000000,
            25868039185989 / 1000000000000000000,
            30735985291011 / 2000000000000000000,
            145698734947689 / 4000000000000000000,
            173116877629311 / 2000000000000000000,
            205694670793689 / 4000000000000000000,
            597517197849 / 2000000000000000000,
            709960259151 / 1000000000000000000,
            843563283849 / 2000000000000000000,
            3998768939451 / 1000000000000000000,
            4751272503549 / 500000000000000000,
            5645385053451 / 1000000000000000000,
            26760992133249 / 2000000000000000000,
            31796977523751 / 1000000000000000000,
            37780653819249 / 2000000000000000000,
            1394206794981 / 1000000000000000000,
            1656573938019 / 500000000000000000,
            1968314328981 / 1000000000000000000,
            9330460858719 / 500000000000000000,
            11086302508281 / 250000000000000000,
            13172565124719 / 500000000000000000,
            62442314977581 / 1000000000000000000,
            74192947555419 / 500000000000000000,
            88154858911581 / 1000000000000000000,
            3253149188289 / 2000000000000000000,
            3865339188711 / 1000000000000000000,
            4592733434289 / 2000000000000000000,
            21771075337011 / 1000000000000000000,
            25868039185989 / 500000000000000000,
            30735985291011 / 1000000000000000000,
            145698734947689 / 2000000000000000000,
            173116877629311 / 1000000000000000000,
            205694670793689 / 2000000000000000000,
            597517197849 / 4000000000000000000,
            709960259151 / 2000000000000000000,
            843563283849 / 4000000000000000000,
            3998768939451 / 2000000000000000000,
            4751272503549 / 1000000000000000000,
            5645385053451 / 2000000000000000000,
            26760992133249 / 4000000000000000000,
            31796977523751 / 2000000000000000000,
            37780653819249 / 4000000000000000000,
            1394206794981 / 2000000000000000000,
            1656573938019 / 1000000000000000000,
            1968314328981 / 2000000000000000000,
            9330460858719 / 1000000000000000000,
            11086302508281 / 500000000000000000,
            13172565124719 / 1000000000000000000,
            62442314977581 / 2000000000000000000,
            74192947555419 / 1000000000000000000,
            88154858911581 / 2000000000000000000,
            3253149188289 / 4000000000000000000,
            3865339188711 / 2000000000000000000,
            4592733434289 / 4000000000000000000,
            21771075337011 / 2000000000000000000,
            25868039185989 / 1000000000000000000,
            30735985291011 / 2000000000000000000,
            145698734947689 / 4000000000000000000,
            173116877629311 / 2000000000000000000,
            205694670793689 / 4000000000000000000,
            31448273571 / 8000000000000000000,
            37366329429 / 4000000000000000000,
            44398067571 / 8000000000000000000,
            210461523129 / 4000000000000000000,
            250066973871 / 2000000000000000000,
            297125529129 / 4000000000000000000,
            1408473270171 / 8000000000000000000,
            1673525132829 / 4000000000000000000,
            1988455464171 / 8000000000000000000,
            73379304999 / 4000000000000000000,
            87188102001 / 2000000000000000000,
            103595490999 / 4000000000000000000,
            491076887301 / 2000000000000000000,
            583489605699 / 1000000000000000000,
            693292901301 / 2000000000000000000,
            3286437630399 / 4000000000000000000,
            3904891976601 / 2000000000000000000,
            4639729416399 / 4000000000000000000,
            171218378331 / 8000000000000000000,
            203438904669 / 4000000000000000000,
            241722812331 / 8000000000000000000,
            1145846070369 / 4000000000000000000,
            1361475746631 / 2000000000000000000,
            1617683436369 / 4000000000000000000,
            7668354470931 / 8000000000000000000,
            9111414612069 / 4000000000000000000,
            10826035304931 / 8000000000000000000,
            31448273571 / 4000000000000000000,
            37366329429 / 2000000000000000000,
            44398067571 / 4000000000000000000,
            210461523129 / 2000000000000000000,
            250066973871 / 1000000000000000000,
            297125529129 / 2000000000000000000,
            1408473270171 / 4000000000000000000,
            1673525132829 / 2000000000000000000,
            1988455464171 / 4000000000000000000,
            73379304999 / 2000000000000000000,
            87188102001 / 1000000000000000000,
            103595490999 / 2000000000000000000,
            491076887301 / 1000000000000000000,
            583489605699 / 500000000000000000,
            693292901301 / 1000000000000000000,
            3286437630399 / 2000000000000000000,
            3904891976601 / 1000000000000000000,
            4639729416399 / 2000000000000000000,
            171218378331 / 4000000000000000000,
            203438904669 / 2000000000000000000,
            241722812331 / 4000000000000000000,
            1145846070369 / 2000000000000000000,
            1361475746631 / 1000000000000000000,
            1617683436369 / 2000000000000000000,
            7668354470931 / 4000000000000000000,
            9111414612069 / 2000000000000000000,
            10826035304931 / 4000000000000000000,
            31448273571 / 8000000000000000000,
            37366329429 / 4000000000000000000,
            44398067571 / 8000000000000000000,
            210461523129 / 4000000000000000000,
            250066973871 / 2000000000000000000,
            297125529129 / 4000000000000000000,
            1408473270171 / 8000000000000000000,
            1673525132829 / 4000000000000000000,
            1988455464171 / 8000000000000000000,
            73379304999 / 4000000000000000000,
            87188102001 / 2000000000000000000,
            103595490999 / 4000000000000000000,
            491076887301 / 2000000000000000000,
            583489605699 / 1000000000000000000,
            693292901301 / 2000000000000000000,
            3286437630399 / 4000000000000000000,
            3904891976601 / 2000000000000000000,
            4639729416399 / 4000000000000000000,
            171218378331 / 8000000000000000000,
            203438904669 / 4000000000000000000,
            241722812331 / 8000000000000000000,
            1145846070369 / 4000000000000000000,
            1361475746631 / 2000000000000000000,
            1617683436369 / 4000000000000000000,
            7668354470931 / 8000000000000000000,
            9111414612069 / 4000000000000000000,
            10826035304931 / 8000000000000000000,
            114675017769 / 16000000000000000000,
            136254999231 / 8000000000000000000,
            161895983769 / 16000000000000000000,
            767440503531 / 8000000000000000000,
            911860379469 / 4000000000000000000,
            1083457737531 / 8000000000000000000,
            5135947985169 / 16000000000000000000,
            6102450231831 / 8000000000000000000,
            7250832551169 / 16000000000000000000,
            267575041461 / 8000000000000000000,
            317928331539 / 4000000000000000000,
            377757295461 / 8000000000000000000,
            1790694508239 / 4000000000000000000,
            2127674218761 / 2000000000000000000,
            2528068054239 / 4000000000000000000,
            11983878632061 / 8000000000000000000,
            14239050540939 / 4000000000000000000,
            16918609286061 / 8000000000000000000,
            624341763409 / 16000000000000000000,
            741832773591 / 8000000000000000000,
            881433689409 / 16000000000000000000,
            4178287185891 / 8000000000000000000,
            4964573177109 / 4000000000000000000,
            5898825459891 / 8000000000000000000,
            27962383474809 / 16000000000000000000,
            33224451262191 / 8000000000000000000,
            39476755000809 / 16000000000000000000,
            114675017769 / 8000000000000000000,
            136254999231 / 4000000000000000000,
            161895983769 / 8000000000000000000,
            767440503531 / 4000000000000000000,
            911860379469 / 2000000000000000000,
            1083457737531 / 4000000000000000000,
            5135947985169 / 8000000000000000000,
            6102450231831 / 4000000000000000000,
            7250832551169 / 8000000000000000000,
            267575041461 / 4000000000000000000,
            317928331539 / 2000000000000000000,
            377757295461 / 4000000000000000000,
            1790694508239 / 2000000000000000000,
            2127674218761 / 1000000000000000000,
            2528068054239 / 2000000000000000000,
            11983878632061 / 4000000000000000000,
            14239050540939 / 2000000000000000000,
            16918609286061 / 4000000000000000000,
            624341763409 / 8000000000000000000,
            741832773591 / 4000000000000000000,
            881433689409 / 8000000000000000000,
            4178287185891 / 4000000000000000000,
            4964573177109 / 2000000000000000000,
            5898825459891 / 4000000000000000000,
            27962383474809 / 8000000000000000000,
            33224451262191 / 4000000000000000000,
            39476755000809 / 8000000000000000000,
            114675017769 / 16000000000000000000,
            136254999231 / 8000000000000000000,
            161895983769 / 16000000000000000000,
            767440503531 / 8000000000000000000,
            911860379469 / 4000000000000000000,
            1083457737531 / 8000000000000000000,
            5135947985169 / 16000000000000000000,
            6102450231831 / 8000000000000000000,
            7250832551169 / 16000000000000000000,
            267575041461 / 8000000000000000000,
            317928331539 / 4000000000000000000,
            377757295461 / 8000000000000000000,
            1790694508239 / 4000000000000000000,
            2127674218761 / 2000000000000000000,
            2528068054239 / 4000000000000000000,
            11983878632061 / 8000000000000000000,
            14239050540939 / 4000000000000000000,
            16918609286061 / 8000000000000000000,
            624341763409 / 16000000000000000000,
            741832773591 / 8000000000000000000,
            881433689409 / 16000000000000000000,
            4178287185891 / 8000000000000000000,
            4964573177109 / 4000000000000000000,
            5898825459891 / 8000000000000000000,
            27962383474809 / 16000000000000000000,
            33224451262191 / 8000000000000000000,
            39476755000809 / 16000000000000000000,
            6035527251 / 8000000000000000000,
            7171315749 / 4000000000000000000,
            8520841251 / 8000000000000000000,
            40391605449 / 4000000000000000000,
            47992651551 / 2000000000000000000,
            57024091449 / 4000000000000000000,
            270313051851 / 8000000000000000000,
            321181591149 / 4000000000000000000,
            381622765851 / 8000000000000000000,
            14082896919 / 4000000000000000000,
            16733070081 / 2000000000000000000,
            19881962919 / 4000000000000000000,
            94247079381 / 2000000000000000000,
            111982853619 / 1000000000000000000,
            133056213381 / 2000000000000000000,
            630730454319 / 4000000000000000000,
            749423712681 / 2000000000000000000,
            890453120319 / 4000000000000000000,
            32860092811 / 8000000000000000000,
            39043830189 / 4000000000000000000,
            46391246811 / 8000000000000000000,
            219909851889 / 4000000000000000000,
            261293325111 / 2000000000000000000,
            310464497889 / 4000000000000000000,
            1471704393411 / 8000000000000000000,
            1748655329589 / 4000000000000000000,
            2077723947411 / 8000000000000000000,
            6035527251 / 4000000000000000000,
            7171315749 / 2000000000000000000,
            8520841251 / 4000000000000000000,
            40391605449 / 2000000000000000000,
            47992651551 / 1000000000000000000,
            57024091449 / 2000000000000000000,
            270313051851 / 4000000000000000000,
            321181591149 / 2000000000000000000,
            381622765851 / 4000000000000000000,
            14082896919 / 2000000000000000000,
            16733070081 / 1000000000000000000,
            19881962919 / 2000000000000000000,
            94247079381 / 1000000000000000000,
            111982853619 / 500000000000000000,
            133056213381 / 1000000000000000000,
            630730454319 / 2000000000000000000,
            749423712681 / 1000000000000000000,
            890453120319 / 2000000000000000000,
            32860092811 / 4000000000000000000,
            39043830189 / 2000000000000000000,
            46391246811 / 4000000000000000000,
            219909851889 / 2000000000000000000,
            261293325111 / 1000000000000000000,
            310464497889 / 2000000000000000000,
            1471704393411 / 4000000000000000000,
            1748655329589 / 2000000000000000000,
            2077723947411 / 4000000000000000000,
            6035527251 / 8000000000000000000,
            7171315749 / 4000000000000000000,
            8520841251 / 8000000000000000000,
            40391605449 / 4000000000000000000,
            47992651551 / 2000000000000000000,
            57024091449 / 4000000000000000000,
            270313051851 / 8000000000000000000,
            321181591149 / 4000000000000000000,
            381622765851 / 8000000000000000000,
            14082896919 / 4000000000000000000,
            16733070081 / 2000000000000000000,
            19881962919 / 4000000000000000000,
            94247079381 / 2000000000000000000,
            111982853619 / 1000000000000000000,
            133056213381 / 2000000000000000000,
            630730454319 / 4000000000000000000,
            749423712681 / 2000000000000000000,
            890453120319 / 4000000000000000000,
            32860092811 / 8000000000000000000,
            39043830189 / 4000000000000000000,
            46391246811 / 8000000000000000000,
            219909851889 / 4000000000000000000,
            261293325111 / 2000000000000000000,
            310464497889 / 4000000000000000000,
            1471704393411 / 8000000000000000000,
            1748655329589 / 4000000000000000000,
            2077723947411 / 8000000000000000000,
            317659329 / 16000000000000000000,
            377437671 / 8000000000000000000,
            448465329 / 16000000000000000000,
            2125873971 / 8000000000000000000,
            2525929029 / 4000000000000000000,
            3001267971 / 8000000000000000000,
            14227002729 / 16000000000000000000,
            16904294271 / 8000000000000000000,
            20085408729 / 16000000000000000000,
            741205101 / 8000000000000000000,
            880687899 / 4000000000000000000,
            1046419101 / 8000000000000000000,
            4960372599 / 4000000000000000000,
            5893834401 / 2000000000000000000,
            7002958599 / 4000000000000000000,
            33196339701 / 8000000000000000000,
            39443353299 / 4000000000000000000,
            46865953701 / 8000000000000000000,
            1729478569 / 16000000000000000000,
            2054938431 / 8000000000000000000,
            2441644569 / 16000000000000000000,
            11574202731 / 8000000000000000000,
            13752280269 / 4000000000000000000,
            16340236731 / 8000000000000000000,
            77458125969 / 16000000000000000000,
            92034491031 / 8000000000000000000,
            109353891969 / 16000000000000000000,
            317659329 / 8000000000000000000,
            377437671 / 4000000000000000000,
            448465329 / 8000000000000000000,
            2125873971 / 4000000000000000000,
            2525929029 / 2000000000000000000,
            3001267971 / 4000000000000000000,
            14227002729 / 8000000000000000000,
            16904294271 / 4000000000000000000,
            20085408729 / 8000000000000000000,
            741205101 / 4000000000000000000,
            880687899 / 2000000000000000000,
            1046419101 / 4000000000000000000,
            4960372599 / 2000000000000000000,
            5893834401 / 1000000000000000000,
            7002958599 / 2000000000000000000,
            33196339701 / 4000000000000000000,
            39443353299 / 2000000000000000000,
            46865953701 / 4000000000000000000,
            1729478569 / 8000000000000000000,
            2054938431 / 4000000000000000000,
            2441644569 / 8000000000000000000,
            11574202731 / 4000000000000000000,
            13752280269 / 2000000000000000000,
            16340236731 / 4000000000000000000,
            77458125969 / 8000000000000000000,
            92034491031 / 4000000000000000000,
            109353891969 / 8000000000000000000,
            317659329 / 16000000000000000000,
            377437671 / 8000000000000000000,
            448465329 / 16000000000000000000,
            2125873971 / 8000000000000000000,
            2525929029 / 4000000000000000000,
            3001267971 / 8000000000000000000,
            14227002729 / 16000000000000000000,
            16904294271 / 8000000000000000000,
            20085408729 / 16000000000000000000,
            741205101 / 8000000000000000000,
            880687899 / 4000000000000000000,
            1046419101 / 8000000000000000000,
            4960372599 / 4000000000000000000,
            5893834401 / 2000000000000000000,
            7002958599 / 4000000000000000000,
            33196339701 / 8000000000000000000,
            39443353299 / 4000000000000000000,
            46865953701 / 8000000000000000000,
            1729478569 / 16000000000000000000,
            2054938431 / 8000000000000000000,
            2441644569 / 16000000000000000000,
            11574202731 / 8000000000000000000,
            13752280269 / 4000000000000000000,
            16340236731 / 8000000000000000000,
            77458125969 / 16000000000000000000,
            92034491031 / 8000000000000000000,
            109353891969 / 16000000000000000000,
        ]

        output = genotype_probabilities(input_mafs)

        for par in zip(expected_output, output):
            self.assertAlmostEqual(par[0], par[1])  # Default precision 7 decimals

    def test_compute_prevalence_1(self):
        """Test that PyToxo and Toxo `compute_prevalence` functions work
        equal with a given configuration. In Toxo, this function is the method
        `p = prevalence(obj, mafs, gp)` of the `PTable` class; in PyToxo it
        has been refactored to an independent function."""
        input_penetrances = [
            0.2589158758688671,
            0.4692129571716719,
            0.3646383680654557,
            0.490777573993914,
            0.5020410805786457,
            0.36819868656603394,
            0.12013219628777405,
            0.626111833703049,
            0.14207012897125182,
            0.34859830286644566,
            0.6779024685225011,
            0.08827936891397803,
            0.4350358298259681,
            0.6022663885821758,
            0.9474134576051509,
            0.009043110474026061,
            0.9753576496514897,
            0.44532536005752865,
            0.8345931481010112,
            0.8259834049333902,
            0.013271939592359838,
            0.8743197369513187,
            0.45483621921829664,
            0.46948518779113235,
            0.22784703471051548,
            0.075431174804928,
            0.17057404807699605,
        ]  # These are simply mock values to assert the calculation correction and accuracy
        input_mafs = [0.1, 0.08, 0.74]
        input_gp = genotype_probabilities(input_mafs)

        """Output from Toxo's `p = prevalence(obj, mafs, gp)` function for 
        `input_penetrances`, `input_mafs` and `input_gp` input. Forced 
        output in a Matlab debugging session"""
        expected_output = 0.40144105104785651915693307500987

        output = compute_prevalence(input_penetrances, input_mafs, input_gp)

        self.assertAlmostEqual(expected_output, output)  # Default precision 7 decimals

    def test_compute_prevalence_2(self):
        """Test that PyToxo and Toxo `compute_prevalence` functions work
        equal with a given configuration. In Toxo, this function is the method
        `p = prevalence(obj, mafs, gp)` of the `PTable` class; in PyToxo it
        has been refactored to an independent function."""
        input_penetrances = [
            839.2878566124077,
            315.9453559692004,
            421.03960640663183,
            691.7630195711189,
            37.7162839318429,
            126.64029134369217,
            117.69204297051768,
            618.7825832529591,
            404.29131112494395,
            627.6111059002137,
            470.9833278837673,
            113.0433123924197,
            527.8594415304226,
            237.8502326249068,
            528.4804845478371,
            752.3707762253403,
            524.6192103000715,
            366.3392103818515,
            641.6237937506357,
            564.6554211939755,
            729.314716298435,
            264.7105675910287,
            892.7888718410087,
            120.09477331376341,
            861.3025523656033,
            745.1922421657799,
            732.1534135272663,
        ]  # These are simply mock values to assert the calculation correction and accuracy
        input_mafs = [0.01, 0.34, 0.002]
        input_gp = genotype_probabilities(input_mafs)

        """Output from Toxo's `p = prevalence(obj, mafs, gp)` function for 
        `input_penetrances`, `input_mafs` and `input_gp` input. Forced 
        output in a Matlab debugging session"""
        expected_output = 685.98053933311562259667558609863

        output = compute_prevalence(input_penetrances, input_mafs, input_gp)

        self.assertAlmostEqual(expected_output, output)  # Default precision 7 decimals

    def test_compute_prevalence_3(self):
        """Test that PyToxo and Toxo `compute_prevalence` functions work
        equal with a given configuration. In Toxo, this function is the method
        `p = prevalence(obj, mafs, gp)` of the `PTable` class; in PyToxo it
        has been refactored to an independent function."""
        input_penetrances = [
            95.8664528902537,
            107.846688399269,
            -93.62595461309878,
            -24.44462181519748,
            -82.04905759379164,
            -68.13774680416012,
            74.07501528050682,
            87.54870240631405,
            -32.17547812697022,
            -0.14578541128821598,
            -90.62884044170451,
            -51.16403082025444,
            -104.50845286057239,
            41.24370991036267,
            34.245892227604145,
            -15.408900376091736,
            -48.831684783979696,
            80.3688781558649,
            -71.8120695585337,
            56.76116574424435,
            -83.4879650020254,
            116.88397011638688,
            -38.05750121385162,
            -103.86636959299118,
            -27.655163812967118,
            107.35569341850186,
            119.26611877333363,
        ]  # These are simply mock values to assert the calculation correction and accuracy
        input_mafs = [0.0005, 0.012, 0.05678]
        input_gp = genotype_probabilities(input_mafs)

        """Output from Toxo's `p = prevalence(obj, mafs, gp)` function for 
        `input_penetrances`, `input_mafs` and `input_gp` input. Forced 
        output in a Matlab debugging session"""
        expected_output = 93.411917433245971426364773230649

        output = compute_prevalence(input_penetrances, input_mafs, input_gp)

        self.assertAlmostEqual(expected_output, output)  # Default precision 7 decimals


if __name__ == "__main__":
    unittest.main()
